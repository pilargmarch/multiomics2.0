# :dna: Data

Since the data files are too large to store on GitHub, here is the structure of the data folder with direct links to said files stored in [this MEGA folder](https://mega.nz/folder/Kl8h1LJJ#oactgNw1q3Wwu5qZaLdnkA). All TCGA-BRCA (breast cancer) data was downloaded with R/Bioconductor package `TCGAbiolinks` using Harmonized mode, which prepares data in a different way to Legacy (e.g. using `STAR` counts instead of `RSEM` estimated counts in the case of RNA-Seq) and aligns reads against human assembly GRCh38 (hg38). `.rda` files can be directly loaded into R.

*Note: some tumor samples had more than 1 files associated with them, for RNA-Seq, miRNA-Seq and methylation data, meaning some samples had to be removed or merged with other existing ones following [Broad's Institute guideline on replicate samples](https://gdac.broadinstitute.org/runs/gdc/report_2017_08_02/TCGA-LGG_Replicate_Samples.html), which recommends keeping samples with the highest lexicographical sort value for the plate number. When this was unclear, FFPE (formalin fixed paraffin embedded) samples were removed, since [they are not suitable for molecular analysis because the RNA and DNA are trapped in the nucleic acid-protein cross linking from the fixation process](https://gdac.broadinstitute.org/runs/stddata__2014_04_16/samples_report/FFPE_Cases.html). Cooked data DOES NOT have any duplicates, only raw data does.

[Clinical data](https://mega.nz/file/v1kRAJrY#iuQLEVNJdpAYbpf3vkNWYPJemNf0eJ2_n_jzQY2TGrU) for the 848 samples that were finally used.

## ü•© Raw data

### :one: RNA-Seq

`RangedSummarizedExperiment` objects generated by `TCGAbiolinks` containing (among other information) `unstranded`, `stranded_first`, `stranded_second`, `tpm_unstrand`, `fpkm_unstrand` and `fpkm_uq_unstrand` counts for 60,660 genes. `Unstranded` counts were used.

- **[RNA.rda (506.2 MB)](https://mega.nz/file/6lsX0QyQ#BhxdMgi1FXMRclh0uA23dLlLp96E-EVcfCO8SAa2U_A)**: with data for 857 samples that also have data for miRNA-Seq and methylation.

### :two: miRNA-Seq

Data frame generated by `TCGAbiolinks` with `read_counts`, `reads_per_million_miRNA_mapped` and `cross-mapped` counts for 3,999,876 isoform miRNA regions. `read_counts` were summed to get the expression of each mature miRNA

- **[miRNA.rda (3.6 MB)](https://mega.nz/file/ms0XiagK#_qetGXK7kRTigXOpM8FTqQ4UVTTDUmdk_p63cIReueE)**: with counts for 3,999,876 isoform miRNA regions and 864 samples.
- **[miRNA.mature.rda (1.6 MB)](https://mega.nz/file/P88jGYZa#lCXkIbuP4Q0rtufJ3dSYCWQHUdLwJlyOoe-TKEAai2o)**: with raw counts for 2,209 mature miRNAs and 848 samples.

### :three: Methylation

`RangedSummarizedExperiment` objects generated by `TCGAbiolinks` containing (among other information) methylation beta-values for 485,577 CpG islands obtained by mapping HM450 probes to the GRCh38 reference genome.

- **[met.rda (2.48 GB)](https://mega.nz/file/C0N3TaRb#CJmugJQ6-4OeKDhRXG4qxlubuvepJ7Nt1eYRtXSHED8)**: with data for 857 samples.

### :four: Proteomics

Data frame generated by `TCGAbiolinks` with quantified and normalized (median-centered, log2-transformed) protein expression for 487 peptide targets.

- **[prot.rda (1.9 MB)](https://mega.nz/file/78d2yTJZ#JwJG9bAUJ_Uo2WPRfWH2wiK4gy0KZ1TdhdMDdk8TqrY)**: with data for 643 samples.

## üçñ Cooked

### :one: RNA-Seq

Raw counts were first filtered by setting a CPM threshold of 0.5 and a cv.cutoff of 500 with `NOISeq`. These filtered counts were then normalized with `cqn` by correcting for sample-specific gene GC-content and length biases, as well as for between-sample effects.

- **[RNA.filt.rda (33.4 MB)](https://mega.nz/file/PtFmkboQ#mmNkYK8LpzJpamnlvIxal_0_CLUHJKlH1LLK7TbuCGU)**: raw filtered counts for 19,318 genes and 848 samples.

- **[RNA.norm.Factors.rda (118.2 MB)](https://mega.nz/file/escgiK6Z#ywORrp2BQexBd970EYTSkunqTrHNCgzQWp-g05k7TCo)**: normalization factors obtained with `cqn`. 

- **[RNA.norm.rda (336 MB)](https://mega.nz/file/etFylLYJ#u3JQaeOXBRphTSrswevixvOu5x9rDYpDcqKpGpjXD9o)**: normalized expression matrix obtained with `cqn`. 

### :two: miRNA-Seq

Raw counts were first filtered by setting a CPM threshold of 0.5 and a cv.cutoff of 500 with `NOISeq`.

- **[miRNA.filt.rda (1 MB)](https://mega.nz/file/zpMHWSDJ#etCQsbkIapyNvCmH2oM0pbX__btqzaVsGNJiIFMdMnU)**: raw filtered counts for 642 mature miRNAs and 848 samples.

### :three: Methylation

Probes that had any NA's were removed, as well as probes with all 0 values (of which there were none in this case). 

- **[bval.rda (2.16 GB)](https://mega.nz/file/rp8lDZoK#RJjGWpAnoD-JTHuQwfxWwiD5IeMcgSjbWNuP5pRMh6c)**: filtered methylation beta-values for 364,019 CpG sites and 848 samples.

- **[mval.rda (2.16 GB)](https://mega.nz/file/ToUDHYjL#IXjaW6CwRgy37OOo77kCp1rSq_IC4TeaxkqrrbAyQ2k)**: M-values converted from beta-values through a logistic transformation for 364,019 CpG sites.

### :four: Proteomics

- **[prot.filt.rda (1.5 MB)](https://mega.nz/file/ntsWjLAT#wfDDHQnmI0PKFM1emImYdM3vCMikKGIy9_vGp66auRc)**: normalized (median-centered, log2-transformed) expression matrix for 369 protein targets converted to Entrez IDs and 625 samples, with no missing values.